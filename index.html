<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="https://raw.githubusercontent.com/andyjjrt/money/master/book_icon6765.ico"/>
    <link rel="bookmark" href="https://raw.githubusercontent.com/andyjjrt/money/master/book_icon6765.ico">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#e6faf8"/>
    <link rel='apple-touch-icon' sizes='192x192' href='https://raw.githubusercontent.com/andyjjrt/money/master/book_icon6765.ico'/>
    <meta name='apple-mobile-web-app-capable' content='yes'>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <title>記帳</title>
  </head>
  <body  style="font-family:Microsoft JhengHei;">
    
    <nav class="navbar navbar-dark bg-dark">
      <span class="navbar-brand mb-0 h1">記帳</span>
      <form class="form-inline" id="remain">
        
      </form>
    </nav>
    
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel"></h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label>你的網址</label>
              <input type="text" class="form-control" id="urlgenerate" disabled>
            </div>
            <a role="button" class="btn btn-block btn-primary" onclick="go()">前往</a>
          </div>
        </div>
      </div>
    </div>
    
    <div class="container">
    <div class="tab-content" id="v-pills-tabContent">
      <div class="tab-pane fade show active" id="loading" role="tabpanel">
        <br>
        <div class="text-center">
          <div class="spinner-border" style="width: 3rem; height: 3rem;" role="status">
          <span class="sr-only">Loading...</span>
        </div>
        <h3>
          Loading......
        </h3>
      </div>
    </div>
    <div class="tab-pane fade" id="table" role="tabpanel">
        <br>
        <div class="clearfix">
          <button class="btn btn-secondary float-right" onclick="sw('menu','table')">
            <svg width="1.5em" height="1.5em" viewbox="0 0 16 16" class="bi bi-house-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 3.293l6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293l6-6zm5-.793V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/><path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"/></svg>
          </button>
          <div class="dropdown">
            <button class="btn btn-outline-dark dropdown-toggle float-left" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <!--
              <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-funnel-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5v-2z"/>
              </svg>
              -->
              <svg width="1em" height="1em" viewbox="0 0 16 16" class="bi bi-funnel" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5v-2zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2h-11z"/>
              </svg>&nbsp;
              按日期新到舊
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
              <h4 class="dropdown-header">排序方式</h4>
              <button class="dropdown-item" type="button" onclick="init2('按日期新到舊')">按日期新到舊</button>
              <button class="dropdown-item" type="button" onclick="init2('按日期舊到新')">按日期舊到新</button>
              <button class="dropdown-item" type="button" onclick="init2('支出')">支出</button>
              <button class="dropdown-item" type="button" onclick="init2('收入')">收入</button>
              <button class="dropdown-item" type="button" onclick="init2('早餐')"><span class="badge badge-primary">&nbsp;</span>&nbsp;早餐</button>
              <button class="dropdown-item" type="button" onclick="init2('午餐')"><span class="badge badge-secondary">&nbsp;</span>&nbsp;午餐</button>
              <button class="dropdown-item" type="button" onclick="init2('晚餐')"><span class="badge badge-success">&nbsp;</span>&nbsp;晚餐</button>
              <button class="dropdown-item" type="button" onclick="init2('交通')"><span class="badge badge-danger">&nbsp;</span>&nbsp;交通</button>
              <button class="dropdown-item" type="button" onclick="init2('食物')"><span class="badge badge-warning">&nbsp;</span>&nbsp;食物</button>
              <button class="dropdown-item" type="button" onclick="init2('文具')"><span class="badge badge-info">&nbsp;</span>&nbsp;文具</button>
              <button class="dropdown-item" type="button" onclick="init2('其他')"><span class="badge badge-dark">&nbsp;</span>&nbsp;其他</button>
            </div>
          </div>
        </div>
      <br>
        <table class="table">
          <thead class="thead-dark">
            <tr>
              <th scope="col">時間</th>
              <th scope="col">
                <svg width="1.8em" height="1.8em" viewbox="0 0 16 16" class="bi bi-chat-left-text-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4.414a1 1 0 0 0-.707.293L.854 15.146A.5.5 0 0 1 0 14.793V2zm3.5 1a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1h-9zm0 2.5a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1h-9zm0 2.5a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5z"/>
                </svg>
              </th>
              <th scope="col">項目</th>
              <th scope="col">金額</th>
            </tr>
          </thead>
          <tbody id="detailarea">
          </tbody>
        </table>
    </div>
    <div class="tab-pane fade" id="menu" role="tabpanel">
        <br>
        <div class="row">
          <div class="col">
            <button type="button" class="btn btn-outline-warning btn-block" onclick="sub('支出','0')">支出</button>
          </div>
          <div class="col">
            <button type="button" class="btn btn-outline-success btn-block" onclick="sub('收入','0')">收入</button>
          </div>
        </div>
        
      <br>
      <div style="overflow: auto;display:block">
        <table class="table">
          <thead class="thead-dark">
            <tr>
              <th scope="col">時間</th>
              <th scope="col">
                <svg width="1.8em" height="1.8em" viewbox="0 0 16 16" class="bi bi-chat-left-text-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4.414a1 1 0 0 0-.707.293L.854 15.146A.5.5 0 0 1 0 14.793V2zm3.5 1a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1h-9zm0 2.5a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1h-9zm0 2.5a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5z"/>
                </svg>
              </th>
              <th scope="col">項目</th>
              <th scope="col">金額</th>
            </tr>
          </thead>
          <tbody id="listarea">
          </tbody>
        </table>
        <br>
        <button class="btn btn-primary btn-block" onclick="init2('按日期新到舊')">
          查看更多
        </button>
        <br>
        <br>
      </div>
        

 
    </div>
      <div class="tab-pane fade" id="submitp" role="tabpanel">
        <br>
        <div class="card">
          <div class="clearfix card-header" >
            <h5 id="subheader"></h5>
            
          </div>
          
          <div class="card-body">
            <form id="fr">
              <div class="form-group">
                <input type="text" class="form-control" id="type" disabled>
              </div>
              <div class="form-group">
                <label>日期</label>
                <input type="date" class="form-control" id="time">
              </div>
              <div class="form-group">
                <label>品項</label>
                <input type="text" class="form-control" id="item">
              </div>
              <div class="form-group">
                <label>金額</label>
                <input type="number" class="form-control" id="count">
              </div>
              <div id="tagarea" style="overflow: auto;white-space: nowrap; display:none" >
                <button type="button" class="btn btn-outline-primary" onclick="selecttag('primary',this.id,'早餐')" id="sle0">早餐</button>&nbsp;
                <button type="button" class="btn btn-outline-secondary" onclick="selecttag('secondary',this.id,'午餐')" id="sle1">午餐</button>&nbsp;
                <button type="button" class="btn btn-outline-success" onclick="selecttag('success',this.id,'晚餐')" id="sle2">晚餐</button>&nbsp;
                <button type="button" class="btn btn-outline-danger" onclick="selecttag('danger',this.id,'交通')" id="sle3">交通</button>&nbsp;
                <button type="button" class="btn btn-outline-warning" onclick="selecttag('warning',this.id,'食物')" id="sle4">食物</button>&nbsp;
                <button type="button" class="btn btn-outline-info" onclick="selecttag('info',this.id,'文具')" id="sle5">文具</button>&nbsp;
                <button type="button" class="btn btn-outline-dark" onclick="selecttag('dark',this.id,'其他')" id="sle6">其他</button>&nbsp;
              </div>
              <br>
              <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="writed($('#type').val())">提交</button>
            </form>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="initmenu" role="tabpanel">
        <br>
        <h2>
          請填寫第一筆資料
        </h2>
        <br>
        <div class="row">
          <div class="col">
            <button type="button" class="btn btn-outline-warning btn-block" onclick="sub('支出','1')">支出</button>
          </div>
          <div class="col">
            <button type="button" class="btn btn-outline-success btn-block" onclick="sub('收入','1')">收入</button>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="datamiss" role="tabpanel">
        <br>
        <div class="clearfix">
          <h2>
            請輸入以下必要資料
          </h2>
          <a role="button" class="btn btn-primary float-right" href="tutor.html">前往教學</a>
        </div>
        
        <div class="form-group">
          <label>讀取appscript網址</label>
          <input type="text" class="form-control" id="resrc">
        </div>
        <div class="form-group">
          <label>寫入appscript網址</label>
          <input type="text" class="form-control" id="wrsrc">
        </div>
        <div class="form-group">
          <label>試算表id</label>
          <input type="text" class="form-control" id="datasrc">
        </div>
        <button type="button" class="btn btn-primary btn-block" onclick="crurl()" data-toggle="modal" data-target="#exampleModal">提交</button>
      </div>
      <div class="tab-pane fade" id="oops" role="tabpanel">
        <br>
        <h2>
          Oh...你的資料似乎有些問題
        </h2>
        <div class="alert alert-warning" role="alert" id="errordisplay">
          Error display
        </div>
        <p>
          請檢察網路連接，或檢查你的資料是否有輸入錯誤
        </p>
        <button class="btn btn-block btn-outline-success" onclick="window.location.replace(window.location.href)">
          重新整理頁面
        </button>
        <button class="btn btn-block btn-outline-danger" onclick="sw('datamiss','oops')">
          前往檢查資料
        </button>
      </div>
            
    </div>
</div>
    
    

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <script src="script.js"></script>
  </body>
</html>
