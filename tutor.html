<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="https://raw.githubusercontent.com/andyjjrt/money/master/book_icon6765.ico"/>
    <link rel="bookmark" href="https://raw.githubusercontent.com/andyjjrt/money/master/book_icon6765.ico">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <title>記帳</title>
  </head>
  <body  style="font-family:Microsoft JhengHei;">
    
    <nav class="navbar navbar-dark bg-dark">
      <span class="navbar-brand mb-0 h1">記帳</span>
      <form class="form-inline" id="remain">
        
      </form>
    </nav>
    <div class="container">
      <br>
      <h2>
        1.建立新的試算表
      </h2>
      <h5>
        a.公開試算表為"知道連結的使用者均能查看"
      </h5>
      <img src="https://raw.githubusercontent.com/andyjjrt/money/master/t1.png" class="img-fluid">
      <br><br>
      <h5>
        b.複製該區域文字，此即為試算表id
      </h5>
      <img src="https://raw.githubusercontent.com/andyjjrt/money/master/t2.png" class="img-fluid">
      <hr>
      <h2>
        2.建立新的appscript檔案
      </h2>
      <h5>
        a.前往<a href="https://script.google.com/home">https://script.google.com/home</a>建立兩個新專案，並分別複製以下程式於兩個檔案:
      </h5>
      <br>
      <p>
        讀取程式碼
      </p>
        <div class="bg-dark">
        <small class="text-white">function doGet(e) {
        <br>var params = e.parameter;
        <br>var id = params.uid
        <br>//var uid = params.uid;
        <br>var SpreadSheet = SpreadsheetApp.openById(id);
        <br>var Sheet = SpreadSheet.getSheets()[0];
        <br>var LastRow = Sheet.getLastRow();
        <br>var LastColumn = Sheet.getLastColumn()
        <br>if(LastColumn == 0){
        <br>  var text = [["no data"]]
        <br>  var JSONString = JSON.stringify(text);
        <br>  Logger.log(JSONString);
        <br>  return ContentService.createTextOutput(JSONString)
        <br>    .setMimeType(ContentService.MimeType.JSON);
        <br>}else{
        <br>  var ready = Sheet.getSheetValues(1,1,LastRow,LastColumn);
        <br>  var JSONString = JSON.stringify(ready);
        <br>  Logger.log(JSONString);
        <br>  return ContentService.createTextOutput(JSONString)
        <br>    .setMimeType(ContentService.MimeType.JSON);
        <br>}
        <br>}
        </small>
          </div>
      <br>
      <p>
        寫入程式碼
      </p>
      <div class="bg-dark">
        <small class="text-white">function doGet(e) {
        <br>var params = e.parameter; 
        <br>var type = params.type;
        <br>var time = params.time;
        <br>var item = params.item;
        <br>var count = params.count;
        <br>var tag = params.tag
        <br>var SpreadSheet = SpreadsheetApp.openById("14xeLQsPjrD14YWaMBf4iMVnSYUH81jZpLOm-Drme_HQ");
        <br>var Sheet = SpreadSheet.getSheets()[0];
        <br>var LastRow = Sheet.getLastRow();
        <br>if(time !== undefined){
        <br>  Sheet.getRange(LastRow+1, 1).setValue(time);
        <br>  Sheet.getRange(LastRow+1, 2).setValue(type);
        <br>  Sheet.getRange(LastRow+1, 3).setValue(item);
        <br>  Sheet.getRange(LastRow+1, 4).setValue(count);
        <br>  Sheet.getRange(LastRow+1, 5).setValue(tag);
        <br>  return ContentService.createTextOutput(true);
        <br>}
        <br>return ContentService.createTextOutput('別亂撞我～～ :)');
      <br>}
        </small>
          </div>
      <h5>
        b.按"發布應用程式"發布，此時需要核對權限。 
      </h5>
      <img src="https://raw.githubusercontent.com/andyjjrt/money/master/t3.png" class="img-fluid">
      <h5>
        c.最後會得到一條網址，請分別貼在"讀取appscript網址"與"寫入appscript網址"處。
      </h5>
      <img src="https://raw.githubusercontent.com/andyjjrt/money/master/t4.png" class="img-fluid">
      <br>
    <br>
    <br>
    <a href="index.html" role="button" class="btn btn-block btn-primary">返回</a>
      <br>
    <br>
      <br>
    <br>
    </div>
    
    

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <script src="script.js"></script>
  </body>
</html>
